.fab {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  flex: 0 0 auto;
  padding: 0 !important;
  min-width: 0 !important;
  gap: 0;
  border-radius: 50%;
  aspect-ratio: 1/1;
  cursor: pointer;
  font-family: inherit;
  font-weight: var(--font-weight-medium);
  transform: translateZ(0);
  will-change: transform, box-shadow;
  backface-visibility: hidden;
  transition: transform var(--transition-fast), box-shadow var(--transition-fast);

  /* Neutralize BaseButton hover/active variable-driven background/border changes */
  --button-bg: transparent;
  --button-bg-hover: transparent;
  --button-bg-active: transparent;
  --button-border: none;
  --button-border-hover: none;
  --button-border-active: none;
}

.fab::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-radius: inherit;
  opacity: 0;
  transition: opacity var(--transition-fast);
  z-index: -1;
}

.fab:hover:not(:disabled) {
  
}

.fab:hover:not(:disabled)::before {
  opacity: 1;
}

.fab:focus-visible {
  outline: none;
  box-shadow: var(--shadow-primary-focus);
}

.fab:active:not(:disabled) {
  transform: translateY(0) scale(1);
}

.fab:active:not(:disabled)::before {
  opacity: 1;
}

.fab:disabled {
  cursor: not-allowed;
  opacity: 0.3;
  transform: none;
  box-shadow: var(--shadow-md);
}

.loading {
  cursor: default;
  pointer-events: none;
}

.loading::after {
  content: '';
  position: absolute;
  width: 20px;
  height: 20px;
  border: 2px solid transparent;
  border-top-color: currentColor;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

.pulse {
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
  70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
  100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
}

/* Sizes */
.sizeXs { width: 32px; height: 32px; font-size: var(--font-size-xs); }
.sizeSm { width: 40px; height: 40px; font-size: var(--font-size-sm); }
.sizeMd { width: 56px; height: 56px; font-size: var(--font-size-lg); }
.sizeLg { width: 64px; height: 64px; font-size: var(--font-size-xl); }

/* Positions */
.positionRelative { position: relative; }
.positionFixed { position: fixed; z-index: var(--z-fixed); }
.bottomRight { bottom: var(--space-6); right: var(--space-6); }
.bottomLeft { bottom: var(--space-6); left: var(--space-6); }
.topRight { top: var(--space-6); right: var(--space-6); }
.topLeft { top: var(--space-6); left: var(--space-6); }

/* Variants */
.variantSecondary {
  --gradient-angle: 160deg;
  /* Mirror BaseButton secondary (explicitly set to ensure consistency) */
  --button-bg: linear-gradient(var(--gradient-angle), var(--clr-surface-a0) 0%, var(--clr-surface-a20) 100%);
  --button-bg-hover: linear-gradient(var(--gradient-angle), var(--clr-surface-a0) 0%, var(--clr-surface-a20) 100%);
  --button-bg-active: linear-gradient(var(--gradient-angle), var(--clr-surface-a0) 0%, var(--clr-surface-a20) 100%);
  --button-bg-disabled: linear-gradient(var(--gradient-angle), var(--clr-surface-a50) 0%, var(--clr-surface-a40) 100%);

  --button-color: var(--clr-on-surface-a0);

  --button-border: 1px solid var(--clr-surface-a40);
  --button-border-hover: 1px solid var(--clr-surface-a40);
  --button-border-active: 1px solid var(--clr-surface-a40);
  --button-border-disabled: 1px solid var(--clr-surface-a30);

  --button-shadow: none;
  --button-shadow-hover: none;
  --button-shadow-active: none;
  --button-shadow-focus: var(--shadow-primary-focus);

  transition: all var(--transition-normal), --gradient-angle var(--transition-normal);
  &:hover:not(:disabled), &:active:not(:disabled) {
    --gradient-angle: 0deg;
  }
}

.variantTransparent {
  --button-bg: transparent;
  --button-bg-hover: transparent;
  --button-bg-active: transparent;
  --button-color: var(--clr-text-a10);
  --button-border: none;
  --button-border-hover: none;
  --button-border-active: none;
  --button-shadow: none;
  --button-shadow-hover: var(--shadow-lg);
  --button-shadow-active: var(--shadow-lg);
}

.variantDanger {
  --gradient-angle: 160deg;
  --button-bg: linear-gradient(var(--gradient-angle), var(--clr-danger-a0) 0%, var(--clr-danger-a30) 100%);
  --button-bg-hover: linear-gradient(var(--gradient-angle), var(--clr-danger-a0) 0%, var(--clr-danger-a30) 100%);
  --button-bg-active: linear-gradient(var(--gradient-angle), var(--clr-danger-a0) 0%, var(--clr-danger-a30) 100%);
  --button-bg-disabled: linear-gradient(var(--gradient-angle), var(--clr-surface-a50) 0%, var(--clr-surface-a40) 100%);

  --button-color: var(--clr-on-surface-a0);
  --button-border: none;
  --button-border-hover: none;
  --button-border-active: none;

  --button-shadow: var(--shadow-danger-base), var(--shadow-lg);
  --button-shadow-hover: var(--shadow-danger-hover), var(--shadow-xl);
  --button-shadow-active: var(--shadow-danger-active), var(--shadow-xl);
  --button-shadow-focus: var(--shadow-danger-focus);

  transition: all var(--transition-normal), --gradient-angle var(--transition-normal);
  &:hover:not(:disabled), &:active:not(:disabled) {
    --gradient-angle: 0deg;
  }

}

.variantPrimary {
  --gradient-angle: 160deg;
  --button-bg: linear-gradient(var(--gradient-angle), var(--clr-primary-a0) 0%, var(--clr-primary-a30) 100%);
  --button-bg-hover: linear-gradient(var(--gradient-angle), var(--clr-primary-a0) 0%, var(--clr-primary-a30) 100%);
  --button-bg-active: linear-gradient(var(--gradient-angle), var(--clr-primary-a0) 0%, var(--clr-primary-a30) 100%);
  --button-bg-disabled: linear-gradient(var(--gradient-angle), var(--clr-surface-a50) 0%, var(--clr-surface-a40) 100%);

  --button-color: var(--clr-on-surface-a0);
  --button-border: none;
  --button-border-hover: none;
  --button-border-active: none;

  --button-shadow: var(--shadow-primary-base), var(--shadow-lg);
  --button-shadow-hover: var(--shadow-primary-hover), var(--shadow-xl);
  --button-shadow-active: var(--shadow-primary-active), var(--shadow-xl);
  --button-shadow-focus: var(--shadow-primary-focus);

  transition: all var(--transition-normal), --gradient-angle var(--transition-normal);
  &:hover:not(:disabled), &:active:not(:disabled) {
    --gradient-angle: 0deg;
  }
}

.variantSuccess {
  --gradient-angle: 160deg;
  --button-bg: linear-gradient(var(--gradient-angle), var(--clr-success-a0) 0%, var(--clr-success-a30) 100%);
  --button-bg-hover: linear-gradient(var(--gradient-angle), var(--clr-success-a0) 0%, var(--clr-success-a30) 100%);
  --button-bg-active: linear-gradient(var(--gradient-angle), var(--clr-success-a0) 0%, var(--clr-success-a30) 100%);
  --button-bg-disabled: linear-gradient(var(--gradient-angle), var(--clr-surface-a50) 0%, var(--clr-surface-a40) 100%);

  --button-color: var(--clr-on-surface-a0);
  --button-border: none;
  --button-border-hover: none;
  --button-border-active: none;

  --button-shadow: var(--shadow-success-base), var(--shadow-lg);
  --button-shadow-hover: var(--shadow-success-hover), var(--shadow-xl);
  --button-shadow-active: var(--shadow-success-active), var(--shadow-xl);
  --button-shadow-focus: var(--shadow-success-focus);

  transition: all var(--transition-normal), --gradient-angle var(--transition-normal);
  &:hover:not(:disabled), &:active:not(:disabled) {
    --gradient-angle: 0deg;
  }

}


.active {
  /* non-empty so it can be composed */
  transform: translateZ(0);
}

/* ClassNameFactory compatibility */
.Fab { composes: fab; }
.Fab--pulse { composes: pulse; }
.Fab--loading { composes: loading; }
.Fab--active { composes: active; }
.Fab--sizeXs { composes: sizeXs; }
.Fab--sizeSm { composes: sizeSm; }
.Fab--sizeMd { composes: sizeMd; }
.Fab--sizeLg { composes: sizeLg; }
.Fab--variantSecondary { composes: variantSecondary; }
.Fab--variantTransparent { composes: variantTransparent; }
.Fab--variantDanger { composes: variantDanger; }
.Fab--variantPrimary { composes: variantPrimary; }
.Fab--variantSuccess { composes: variantSuccess; }

/* Use base position classes directly in TS instead of composing here */
.Fab--positionRelative { composes: positionRelative; }
.Fab--positionFixed { composes: positionFixed; }
.Fab--bottomLeft { composes: bottomLeft; }
.Fab--topRight { composes: topRight; }
.Fab--topLeft { composes: topLeft; }
.Fab--bottomRight { composes: bottomRight; }
@media (prefers-contrast: high) {
  .fab { border: 2px solid currentColor; }
}

@media (prefers-reduced-motion: reduce) {
  .fab { transition: none; transform: none !important; animation: none !important; }
  .fab:hover:not(:disabled), .fab:active:not(:disabled) { transform: none; }
}


